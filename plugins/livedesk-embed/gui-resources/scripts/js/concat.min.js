define("utils/class",[],function(){var b=!1,f=function(){};f.extend=function(e,c){function a(){if(!b&&(this._constructor||this._construct))try{return(this._construct||this._constructor).apply(this,arguments)}catch(a){console.error(a)}}b=!0;var d=new this;b=!1;for(var f in e)d[f]=e[f];a.prototype=d;a.prototype.constructor=a;a.extend=arguments.callee;return a};return f});
define("gizmo",["jquery","utils/class"],function(b,f){function e(a,b){var c;if("undefined"==typeof a||"undefined"==typeof b)return!0;for(c in b)if("undefined"==typeof a[c])return!0;for(c in a)if("undefined"==typeof b[c])return!0;for(c in b)if(b[c])switch(typeof b[c]){case "object":if(e(b[c],a[c]))return!0;break;case "function":if("undefined"==typeof a[c]||b[c].toString()!=a[c].toString())return!0;break;default:if(b[c]!=a[c])return!0}else if(a[c])return!0;return!1}var c=function(){},a=function(){},
d=function(){this.items={}},k=function(){},j=f.extend({_construct:function(a){this.data=!this.data?{root:""}:this.data;switch(b.type(a)){case "string":this.data.url=a;break;case "array":this.data.url=a[0];void 0!==a[1]&&(this.data.xfilter=url[0]);break;case "object":this.data.url=a.url,void 0!==a.xfilter&&(this.data.xfilter=a.xfilter)}return this},xfilter:function(){this.data.xfilter=1<arguments.length?b.makeArray(arguments).join(","):b.isArray(arguments[0])?arguments[0].join(","):arguments[0];return this},
root:function(a){this.data.root=a;return this},get:function(){return this.data.root+this.data.url},order:function(a,b){this.data.order=b+"\x3d"+a;return this},filter:function(a,b){this.data.filter=a+"\x3d"+b;return this},decorate:function(a){this.data.url=a.replace(/(%s)/g,this.data.url)},options:function(){var a={};this.data.xfilter&&(a.headers={"X-Filter":this.data.xfilter});return a}}),g={request:function(a){var r=this,c=function(c,d,p){b.support.cors=!0;a instanceof j?(d=b.extend(!0,{},d,r.options,
p,{data:c},a.options()),c=b.ajax(r.href(a.get()),d)):(d=b.extend(!0,{},d,r.options,p,{data:c}),c=b.ajax(r.href(a),d));r.reset();d.fail&&c.fail(d.fail);d.done&&c.done(d.done);d.always&&c.always(d.always);return c};return{read:function(a){return c({},r.readOptions,a)},update:function(a,b){return c(a,r.updateOptions,b)},insert:function(a,b){return c(a,r.insertOptions,b)},remove:function(a){return c({},r.removeOptions,a)}}},href:function(a){return a},reset:b.noop,options:{},readOptions:{dataType:"json",
type:"get",headers:{Accept:"text/json"}},updateOptions:{type:"post",headers:{"X-HTTP-Method-Override":"PUT"}},insertOptions:{dataType:"json",type:"post"},removeOptions:{type:"get",headers:{"X-HTTP-Method-Override":"DELETE"}}},h=0;a.prototype={_changed:!1,_new:!1,defaults:{},data:{},_construct:function(a,c){this._clientId=h++;this.data={};this.parseHash(a);this._new=!0;var d=this.pushUnique?this.pushUnique():this;d._forDelete=!1;d.clearChangeset();d._clientHash=null;c&&"object"==typeof c&&b.extend(d,
c);"object"==typeof a&&d._parse(a);d._setExpiration();d.isDeleted()?d._remove():b.isEmptyObject(d.changeset)?d.clearChangeset().triggerHandler("read"):d.triggerHandler("update",d.changeset).clearChangeset();return d},syncAdapter:g,feed:function(b,c,d){b={};d=d?d:this.data;for(var e in d)b[e]=d[e]instanceof a?c?d[e].feed(c):d[e].relationHash()||d[e].hash():d[e];return b},sync:function(a,c){var d=this,e=b.Deferred(),f=function(){return d.syncAdapter.request.apply(d.syncAdapter,arguments)};this.hash();
d.triggerHandler("sync");if(this._forDelete)return f(a||this.href).remove().done(function(){d._remove()});if(this._clientHash)return f(a||this.href).insert(this.feed()).done(function(a){d._changed=!1;d._parse(a);d._uniq&&d._uniq.replace(d._clientHash,d.hash(),d);d._clientHash=null;d.triggerHandler("insert").Class.triggerHandler("insert",d)});this._changed?b.isEmptyObject(this.changeset)||(e=this.href&&f(this.href).update(c?this.feed():this.feed("json",!1,this.changeset)).done(function(){d.triggerHandler("update",
d.changeset).clearChangeset()})):(!a||!a.force)&&this.exTime&&this.exTime>new Date?d.isDeleted()||d.triggerHandler("update"):e=this.href&&f(this.href).read(a).done(function(a){d._parse(a);d.isDeleted()?d._remove():b.isEmptyObject(d.changeset)?d.clearChangeset().triggerHandler("read"):d.triggerHandler("update",d.changeset).clearChangeset()});this._setExpiration();return e},_setExpiration:function(){this.exTime=new Date;this.exTime.setSeconds(this.exTime.getSeconds()+5)},_remove:function(){this.triggerHandler("delete");
this._uniq&&this._uniq.remove(this.hash())},remove:function(){this._forDelete=!0;return this},isDeleted:function(){return this._forDelete},modelDataBuild:function(a){return a},parse:function(a){return a},_parse:function(d){d=d instanceof a?d.data:this.parse(d);if(!d._parsed){for(var c in d){if(this.defaults[c])switch(!0){case "function"===typeof this.defaults[c]&&void 0===this.data[c]:var f=this.modelDataBuild(new this.defaults[c](d[c]));!this._new&&(f!=this.data[c]&&!(f instanceof k))&&(this.changeset[c]=
f);this.data[c]=f;!d[c].href&&this.data[c].relationHash&&this.data[c].relationHash(d[c]);continue;case b.isArray(this.defaults[c]):this.data[c]=this.modelDataBuild(new k(this.defaults[c][0],d[c].href));delete this.data[c];continue;case this.defaults[c]instanceof k:case this.defaults[c]instanceof a:this.data[c]=this.defaults[c];continue}else this._new||("object"===b.type(d[c])?e(this.data[c],d[c])&&(this.changeset[c]=d[c]):this.data[c]!=d[c]&&(this.changeset[c]=d[c]));"object"===b.type(d[c])&&"object"===
b.type(this.data[c])?b.extend(!0,this.data[c],d[c]):this.data[c]=d[c]}this._new=!1;d._parsed=!0}},parseHash:function(d){if(d instanceof a)return this;"string"==typeof d?this.href=d:d&&void 0!==d.href?(this.href=d.href,delete d.href):d&&(void 0!==d.id&&void 0!==this.url)&&(this.href=this.url+d.id);return this},isChanged:function(){return!b.isEmptyObject(this.changeset)},clearChangeset:function(){this._changed=!1;this.changeset={};return this},get:function(a){return this.data[a]},set:function(a,d,c){var e=
{};"string"===b.type(a)?e[a]=d:(e=a,c=d);c=b.extend({},{silent:!1},c);this.clearChangeset()._parse(e);this._changed=!0;b.isEmptyObject(this.changeset)||c.silent||this.triggerHandler("set",this.changeset);return this},_getClientHash:function(){this._clientHash||(this._clientHash="mcid-"+String(this._clientId));return this._clientHash},hash:function(){!this.href&&this.data.href&&(this.href=this.data.href);return this.data.href||this.href||this._getClientHash()},relationHash:function(a){a&&(this.data.Id=
a);return this.data.Id},off:function(a,d){b(this).off(a,d);return this},on:function(a,d,c){if(void 0===c)b(this).off(a,d),b(this).on(a,d);else b(this).on(a,function(){d.apply(c,arguments)});return this},one:function(a,d,c){if(void 0===c)b(this).off(a,d),b(this).one(a,d);else b(this).one(a,function(){d.apply(c,arguments)});return this},trigger:function(a,d){b(this).trigger(a,d);return this},triggerHandler:function(a,d){b(this).triggerHandler(a,d);return this}};d.prototype={items:{},garbageTime:1500,
refresh:function(a){a._exTime||(a._exTime=new Date);a._exTime.setTime(a._exTime.getTime()+this.garbageTime)},set:function(a,d){var c=this;b(d).on("sync get get-prop set-prop",function(){c.refresh(this)});c.refresh(d);this.items[a]||(this.items[a]=d);return this.items[a]},replace:function(a,d,c){delete this.items[a];return this.set(d,c)},garbage:function(){for(var a in this.items)this.items[a]._exTime&&this.items[a]._exTime<new Date&&(b(this.items[a]).triggerHandler("garbage"),delete this.items[a])},
remove:function(a){delete this.items[a]}};var l=a.options={},m,o;a.extend=m=function(a,d){var e;e=f.extend.call(this,a);e.extend=m;e.prototype.Class=e;e.on=function(a,d,c){b(e).on(a,function(){d.apply(c,arguments)});return e};e.off=function(a,d){b(e).off(a,d);return e};e.triggerHandler=function(a,d){b(e).triggerHandler(a,d)};d&&d.register&&(c[d.register]=e,delete d.register);e.prototype.options=b.extend({},d);return e};k.prototype={_list:[],_events:{},getList:function(){return this._list},count:function(){return this._list.length},
_construct:function(){this.model||(this.model=a);this._list=[];this._events={};this.desynced=!0;for(var d=buildOptions=function(){void 0},c=0,e=arguments.length;c<e;c++)switch(b.type(arguments[c])){case "function":this.model=arguments[c];break;case "string":this.href=arguments[c];break;case "array":d=function(a){return function(){this._list=this._parse(a)}}(arguments[c]);break;case "object":buildOptions=function(a){return function(){this.options=a;a.href&&(this.href=a.href)}}(arguments[c])}buildOptions.call(this);
d.call(this);l=b.extend({},{init:!0},this.options);l.init&&this.init.apply(this,arguments)},init:function(){},get:function(a){var d=b.Deferred(),c=this;searchKey=function(){for(var b=0;b<c._list.length;b++)if(a==c._list[b].hash()||a==c._list[b].relationHash())return d.resolve(c._list[b]);d.reject()};this.desynced&&this.sync().done(function(){d.resolve(searchKey())})?d:searchKey();return d},remove:function(a){for(var d in this._list)if(a==this._list[d].hash()||a==this._list[d].relationHash()){Array.prototype.splice.call(this._list,
d,1);break}return this},syncAdapter:g,setHref:function(a){this.href=a;return this},each:function(a){b.each(this._list,a)},forwardEach:function(a,d){this._list.forEach(a,d)},reverseEach:function(a,d){for(var c=this._list.length;0<c;++c)a.call(d||this,this[c],c,this)},feed:function(a,d){var c=[],b;for(b in this._list)c[b]=this._list[b].feed(a,d);return c},sync:function(a){var d=this;return this.href&&this.syncAdapter.request.call(this.syncAdapter,this.href).read(a).done(function(a){var c=d.parseAttributes(a);
d.parse(a);list=d._parse(a);changeset=[];removeings=[];updates=[];addings=[];count=d._list.length;for(a=0;a<list.length;a++){for(var b=!1,e=0;e<count;e++)if(list[a].hash()==d._list[e].hash()){b=list[a];break}if(b)if(d.hasEvent("updates")&&updates.push(b),d.isCollectionDeleted(b)&&(d._list.splice(a,1),d.hasEvent("removeings")&&removeings.push(b)),b.isDeleted())b._remove();else if(b.isChanged())changeset.push(b);else b.on("delete",function(){d.remove(this.hash())}).on("garbage",function(){this.desynced=
!0});else list[a].isDeleted()?d.hasEvent("updates")&&updates.push(list[a]):(d._list.push(list[a]),changeset.push(list[a]),d.hasEvent("addings")&&addings.push(list[a]))}d.desynced=!1;0===count?d.triggerHandler("read",[d._list,c]):(updates.length&&d.hasEvent("updates")&&d.triggerHandler("updates",[updates,c]),addings.length&&d.hasEvent("addings")&&d.triggerHandler("addings",[addings,c]),removeings.length&&d.hasEvent("removeings")&&d.triggerHandler("removeings",[removeings,c]),d.triggerHandler("update",
[changeset,c]))})},isCollectionDeleted:function(){return!1},modelDataBuild:function(a){return a},parseAttributes:function(a){return a},parse:function(a){var d=a;if(!Array.isArray(a))for(i in a)if(b.isArray(a[i])){d=a[i];break}return d},_parse:function(a){a=this.parse(a);for(var d=[],c=0,b=a.length;c<b;c++)d.push(this.modelDataBuild(new this.model(a[c])));return d},insert:function(d){this.desynced=!1;d instanceof a||(d=this.modelDataBuild(new this.model(d)));this._list.push(d);d.hash();return d.sync(this.href)},
off:function(a,d){b(this).off(a,d);for(var c=a.split(" "),e=0,f=c.length;e<f;e++)delete this._events[c[e]];return this},on:function(a,d,c){if(void 0===c)b(this).off(a,d),b(this).on(a,d);else b(this).on(a,function(){d.apply(c,arguments)});a=a.split(" ");for(var e=0,f=a.length;e<f;e++)this._events[a[e]]=!0;return this},one:function(a,d,c){if(void 0===c)b(this).off(a,d),b(this).one(a,d);else b(this).one(a,function(){d.apply(c,arguments)});return this},trigger:function(a,d){b(this).trigger(a,d);return this},
triggerHandler:function(a,d){b(this).triggerHandler(a,d);return this},hasEvent:function(a){return"undefined"===b.type(this._events[a])?!1:this._events[a]}};k.extend=o=function(a,d){var e;e=f.extend.call(this,a);e.extend=o;d&&d.register&&(c[d.register]=e,delete d.register);e.prototype.options=b.extend({},d);return e};var q=0,s=f.extend({getProperty:function(a){return!this[a]?null:"function"===typeof this[a]?this[a]():this[a]}}).extend({tagName:"div",attributes:{className:"",id:""},namespace:"view",
_constructor:function(a,d){b.extend(this,a);this._clientId=q++;d=b.extend({},{init:!0,events:!0,ensure:!0},d);d.ensure&&this._ensureElement();d.init&&this.init.apply(this,arguments);d.events&&this.resetEvents()},_ensureElement:function(){var a=this.attributes.className,d=this.attributes.id,c="";b(this.el).length?this.el=b(this.el):("string"===b.type(this.el)&&("."==this.el[0]&&(a+=this.el.substr(0,1)),"#"==this.el[0]&&(d=this.el.substr(0,1))),c="\x3c"+this.tagName,""!==a&&(c=c+' class\x3d"'+a+'"'),
""!==d&&(c=c+' id\x3d"'+d+'"'),c=c+"\x3e\x3c/"+this.tagName+"\x3e",this.el=b(c))},init:function(){return this},resetEvents:function(){this.undelegateEvents();this.delegateEvents()},delegateEvents:function(a){if(a||(a=this.getProperty("events")))for(var d in a){var c=a[d],e;for(e in c){var f=c[e];if("string"===typeof f&&b.isFunction(this[f]))b(this.el).on(this.getEvent(e),d,this[f].bind(this))}}},undelegateEvents:function(){b(this.el).off(this.getNamespace());return this},getEvent:function(a){return a+
this.getNamespace()},getNamespace:function(){return"."+this.getProperty("namespace")},render:function(){this.delegateEvents();return this},remove:function(){b(this.el).remove();this.destroy();return this},destroy:function(){this.model&&this.model.trigger("destroy");this.collection&&this.collection.trigger("destroy");return this},checkElement:function(){return void 0===this.el?!1:void 0!==this.el.selector&&""!=this.el.selector?1===b(this.el.selector).length:b(this.el).is(":visible")},setElement:function(a){this.undelegateEvents();
a=b(a);var d=this.el.data();this.el.replaceWith(a);this.el=a;this.el.data(d);this.delegateEvents();return this},resetElement:function(a){this.el=b(a);this._ensureElement();this.delegateEvents()}});return{Model:a,Collection:k,Sync:g,UniqueContainer:d,View:s,Url:j,Register:c}});
define("gizmo/superdesk",["jquery","gizmo"],function(b,f){var e=b.extend({},f.Sync,{reset:function(){try{delete this.options.headers["X-Filter"],this.options.data={}}catch(a){}}}),c=function(){AuthApp.success=function(){};AuthApp.require.apply(this,arguments)},a=b.extend({},e,{options:{fail:function(d){401==d.status&&c.apply(a,arguments);404==d.status&&ErrorApp.require.apply(this,arguments)}},href:function(a){return-1===a.indexOf("my/")?a.replace("resources/","resources/my/"):a}}),d=function(){this.syncAdapter.options.headers||
(this.syncAdapter.options.headers={});this._xfilter=1<arguments.length?b.makeArray(arguments).join(","):b.isArray(arguments[0])?arguments[0].join(","):arguments[0];this.syncAdapter.options.headers["X-Filter"]=this._xfilter;this.syncAdapter.options.headers["X-Format-DateTime"]="yyyy-MM-ddTHH:mm:ss'Z'";return this},k=function(a,d){void 0===a?delete this.syncAdapter.options.data[d]:(void 0===this.syncAdapter.options.data&&(this.syncAdapter.options.data={}),this.syncAdapter.options.data[d]=a);return this},
j=function(a,d){void 0===d&&(d="CId");return k.call(this,a,d+".since")},g=function(a,d){void 0===d&&(d="CId");return k.call(this,a,d+".until")},h=function(a,d){void 0===d&&(d="CId");return k.call(this,a,d+".start")},l=function(a,d){void 0===d&&(d="CId");return k.call(this,a,d+".end")},m=f.Model.extend({isDeleted:function(){return this._forDelete||this.data.DeletedOn},syncAdapter:e,xfilter:d,since:j,until:g,start:h,end:l}),o=function(d){"object"===typeof d&&(d.syncAdapter=a);d.modelDataBuild=function(a){return o(a)};
return d},q=f.Model.extend({syncAdapter:a,xfilter:d,since:j,until:g}),s=f.Collection.extend({xfilter:d,since:j,until:g,start:h,end:l,asc:function(a){return k.call(this,a,"asc")},desc:function(a){return k.call(this,a,"desc")},limit:function(a){return k.call(this,a,"limit")},offset:function(a){return k.call(this,a,"offset")},syncAdapter:e}),d=f.Collection.extend({xfilter:d,since:j,until:g,start:h,end:l,syncAdapter:a});m.extend=function(){var a=f.Model.extend.apply(this,arguments),d=new f.UniqueContainer;
b.extend(a.prototype,{_uniq:d,pushUnique:function(){return d.set(this.hash(),this)}},arguments[0]);return a};return{Auth:o,Model:m,AuthModel:q,Collection:s,AuthCollection:d,Sync:e,AuthSync:a,View:f.View,Url:f.Url,Register:f.Register}});
define("gizmo/view-events",["jquery","gizmo/superdesk"],function(b,f){return b.extend({View:f.View.extend({off:function(e,c){b(this).off(e,c);return this},on:function(e,c,a){if(void 0===a)b(this).off(e,c),b(this).on(e,c);else b(this).on(e,function(){c.apply(a,arguments)});return this},one:function(e,c,a){if(void 0===a)b(this).off(e,c),b(this).one(e,c);else b(this).one(e,function(){c.apply(a,arguments)});return this},trigger:function(e,c){b(this).trigger(e,c);return this},triggerHandler:function(e,
c){b(this).triggerHandler(e,c);return this}})},f)});
define("utils/twitter",[],function(){return{link:{anchor:function(b){return b.replace(/[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z]+:\/\/[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+\.[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_:%&\?\/.=]+/g,function(b){b=b.link(b);return b=b.replace('href\x3d"','target\x3d"_blanka" href\x3d"')})},user:function(b){return b.replace(/[@]+[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+/g,function(b){var e=b.replace("@",
"");b=b.link("http://twitter.com/"+e);return b=b.replace('href\x3d"','target\x3d"_blankb" onclick\x3d"loadProfile(\''+e+'\');return(false);"  href\x3d"')})},tag:function(b){return b.replace(/[#]+[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+/g,function(b){var e=b.replace("#","%23");b=b.link("http://twitter.com/search?q\x3d"+e);return b=b.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},all:function(b){b=this.anchor(b);b=this.user(b);return b=this.tag(b)}}}});
define("utils/utf8",[],function(){return{encode:function(b){return unescape(encodeURIComponent(b))},decode:function(b){return decodeURIComponent(escape(b))}}});
define("dust/dust-helpers",["dust/dust","jquery","utils/twitter","jquery/i18n","jquery/utils"],function(b,f,e){function c(a){return function(c){try{return c=JSON.parse(c),c.annotation[a]}catch(b){}return""}}var a=function(a,c,b,e){if(f.isDefined(e.param1)){var h=[],l;f.each(e,function(b,e){"function"===typeof e&&(val="",a.tap(function(a){val+=a;return""}).render(e,c).untap(),e=val);l=parseInt(b.slice(5))-1;if(isNaN(l)&&window.console)return window.console.log("Invalid parameter "+b+" given!"),[];
h[l]=e});return h}f.each(e,function(b,f){"function"===typeof f&&(val="",a.tap(function(a){val+=a;return""}).render(f,c).untap(),e[b]=val)});return e};b.helpers={i18n:function(d,c,b,e){msgid=e.msgid;msgid_plural=e.msgid_plural;n=e.n;domain=e.domain;msgctxt=e.msgctxt;e&&e.msgid?(delete e.msgid,d.write(f.i18n.dcnpgettext(domain,msgctxt,msgid,msgid_plural,n).format(a(d,c,b,e)))):window.console&&window.console.log("No expression given!");return d},sep:function(a,c,b){return c.stack.index===c.stack.of-
1?a:b.block(a,c)},idx:function(a,c,b){return b.block(a,c.push(c.stack.index))},"if":function(a,c,b,e){var f=e.cond;if(e&&e.cond){"function"===typeof f&&(f="",a.tap(function(a){f+=a;return""}).render(e.cond,c).untap(),""===f&&(f=!1));if(eval(f))return a.render(b.block,c);if(b["else"])return a.render(b["else"],c)}else window.console&&window.console.log("No expression given!");return a}};b.filters.t=function(a){return f("\x3cdiv\x3e"+a+"\x3c/div\x3e").text()};b.filters.twitter_all=function(a){return e.link.all(a)};
b.filters.twitter_annotation_before=c(0);b.filters.twitter_annotation_after=c(1);return b});define("dust/core",["dust/dust","dust/dust-helpers"],function(b){return b});
define("jquery/tmpl",["jquery","dust/core"],function(b,f){b.fn.extend({tmpl:function(e,c,a){if(""!==e)return"#"===e[0]&&(e=e.slice(1)),b.isFunction(c)&&(a=c),this.each(function(){$that=b(this);b.tmpl(e,c,function(d,c){d?window.console&&window.console.log(d):$that.html(c);b.isFunction(a)&&a.apply($that)})})}});b.extend({tmpl:function(b,c,a){f.render(b,c,a)},tmplFn:function(b){return f.compileFn(b)}})});
define("utils/encode_url",[],function(){encodeURL=function(b){return encodeURIComponent(b).replace(/'/g,"%27").replace(/~/g,"%7E").replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29")}});
define("utils/extend",[],function(){Array.prototype.forEach||(Array.prototype.forEach=function(a,d){for(var c=0,b=this.length;c<b;++c)a.call(d||this,this[c],c,this)});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var d=Array.prototype.slice.call(arguments,1),c=this,b=function(){},e=function(){return c.apply(this instanceof b?this:a,d.concat(Array.prototype.slice.call(arguments)))};
b.prototype=this.prototype;e.prototype=new b;return e});String.prototype.trim||(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),d=/\s/,c=a.length;d.test(a.charAt(--c)););return a.slice(0,c+1)});var b=Date,f=b.parse,e=[1,4,5,6,7,10,11];b.parse=function(a){var d,c=0;if(d=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(a)){a=0;for(var j;j=e[a];++a)d[j]=+d[j]||0;d[2]=(+d[2]||1)-1;d[3]=+d[3]||
1;"Z"!==d[8]&&void 0!==d[9]&&(c=60*d[10]+d[11],"+"===d[9]&&(c=0-c));d=b.UTC(d[1],d[2],d[3],d[4],d[5]+c,d[6],d[7])}else d=f?f(a):NaN;return d};if(!Date.prototype.toISOString){var c=function(a){a=String(a);1===a.length&&(a="0"+a);return a};Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,
5)+"Z"}}String.prototype.trunc=function(a,d){var c=this.length>a,b=c?this.substr(0,a-1):this,b=d&&c?b.substr(0,b.lastIndexOf(" ")):b;return c?b+"...":b}});
define("tmpl",["jquery","dust/compiler","dust/i18n_parse","jquery/xdomainrequest"],function(b,f,e){var c=function(){throw Error("Environment unsupported.");},a={};if("undefined"!==typeof window&&window.navigator&&window.document||"undefined"!==typeof importScripts)c=function(a,c){b.ajax({url:a,error:function(a,d){console.log("err");"parsererror"==d&&c(a.responseText)},success:function(a){c(a)}})};return{pluginBuilder:"tmpl-build",write:function(d,c,b){a.hasOwnProperty(c)&&b.asModule(d+"!"+c,a[c])},
load:function(d,b,j,g){var h=b.toUrl(d+".dust");c(h,function(c){c=e(c);try{c="define(['dust'],function(dust){"+f.compile(c,d)+" return {render: function(context, callback) {return dust.render('"+d+"', context, callback)}}})"}catch(b){throw b.message="In "+h+", "+b.message,b;}g.isBuild&&(a[d]=c);g.isBuild||(c+="\r\n//@ sourceURL\x3d"+h);j.fromText("tmpl!"+d,c)})}}});
define("livedesk-embed/views/post","jquery gizmo/superdesk jquery/tmpl jquery/utils utils/encode_url tmpl!theme/item/base tmpl!theme/item/item tmpl!theme/item/annotated tmpl!theme/item/social-share tmpl!theme/item/posttype/normal tmpl!theme/item/posttype/image tmpl!theme/item/posttype/wrapup tmpl!theme/item/posttype/quote tmpl!theme/item/posttype/link tmpl!theme/item/posttype/advertisement tmpl!theme/item/source/advertisement tmpl!theme/item/source/google tmpl!theme/item/source/twitter tmpl!theme/item/source/facebook tmpl!theme/item/source/youtube tmpl!theme/item/source/flickr tmpl!theme/item/source/soundcloud tmpl!theme/item/source/instagram".split(" "),function(b,
f){return f.View.extend({init:function(){var b=this;b.xfilter="PublishedOn, DeletedOn, Order, Id, CId, Content, CreatedOn, Type, AuthorName, Author.Source.Name, Author.Source.Id, IsModified, AuthorPerson.EMail, AuthorPerson.FirstName, AuthorPerson.LastName, AuthorPerson.Id, Meta, IsPublished, Creator.FullName";b.model.on("read update",function(c,a){b._parent.model.get("PostPublished").isCollectionDeleted(b.model)||b.render(c,a)}).on("delete",b.remove,b).xfilter(b.xfilter).sync()},remove:function(){this._parent.removeOne(this);
this.el.remove();this.model.off("read update delete");return this},toggleWrap:function(e,c){"boolean"!=typeof c&&(c=!1);this._toggleWrap(b(e).closest("li").first(),c)},_toggleWrap:function(b){b.hasClass("open")?(b.removeClass("open").addClass("closed"),b.nextUntil(".wrapup,#loading-more").hide()):(b.removeClass("closed").addClass("open"),b.nextUntil(".wrapup,#loading-more").show())},render:function(e,c){var a=this;c=a.model.feed();var d=parseFloat(a.model.get("Order")),f;!isNaN(a.order)&&d!=a.order&&
a._parent.orderOne(a);c.HashIdentifier=a._parent.hashIdentifier;c.Meta&&(c.Meta=JSON.parse(c.Meta));c.Meta&&c.Meta.annotation&&(null===c.Meta.annotation[1]&&(c.Meta.annotation=c.Meta.annotation[0],c.Meta.annotation=b.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],c.Meta.annotation)),"string"!==typeof c.Meta.annotation?c.Meta.annotation[0]?(d=c.Meta.annotation,c.Meta.annotation={before:b.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],d[0]),after:b.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],d[1])}):c.Meta.annotation={before:b.trimTag(["\x3cbr\x3e",
"\x3cbr /\x3e"],c.Meta.annotation.before),after:b.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],c.Meta.annotation.after)}:c.Meta.annotation=b.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],c.Meta.annotation));f=a._parent.hashIdentifier+c.Order;-1===a._parent.location.indexOf("?")?c.permalink=a._parent.location+"?"+f:-1!==a._parent.location.indexOf(a._parent.hashIdentifier)?(d=RegExp(a._parent.hashIdentifier+"[^\x26]*"),c.permalink=a._parent.location.replace(d,f)):c.permalink=a._parent.location+"\x26"+f;"internal"!==
c.Author.Source.Name?c.item="source/"+c.Author.Source.Name:c.Type&&(c.item="posttype/"+c.Type.Key);c.CreatedOn&&(d=new Date(Date.parse(c.CreatedOn)),c.CreatedOn=d.format(_("mm/dd/yyyy HH:MM o")),c.CreatedOnISO=d.getTime());c.Content&&(c.Content=c.Content.replace(livedesk.server(),livedesk.FrontendServer));b.tmpl("theme/item/item",c,function(d,e){if(d)console.error(d);else{a.setElement(e);var f=b('input[data-type\x3d"permalink"]',a.el);b('a[rel\x3d"bookmark"]',a.el).on(a.getEvent("click"),function(d){d.preventDefault();
"visible"===f.css("visibility")?f.css("visibility","hidden"):(f.css("visibility","visible"),f.trigger(a.getEvent("focus")),b(".result-header .share-box",a.el).fadeOut("fast"))});f.on(a.getEvent("focus")+" "+a.getEvent("click"),function(){b(this).select()});b(".big-toggle",a.el).off(a.getEvent("click")).on(a.getEvent("click"),function(){a.toggleWrap(this,!0)});b(".result-header",a.el).parent().hover(function(){},function(){b(this).find(".share-box").fadeOut(100);b('input[data-type\x3d"permalink"]',
a.el).css("visibility","hidden")});b(".sf-share",a.el).on(a.getEvent("click"),function(d){d.preventDefault();var e=b(this);if("yes"!=e.attr("data-added")){d=encodeURL(a._parent.model.get("Title"));var f=encodeURL(c.permalink),k=b(".result-content img:first",a.el).attr("src"),j=encodeURL(b(".result-content .result-text:last",a.el).text()),k="http://pinterest.com/pin/create/button/?url\x3d"+f+"\x26media\x3d"+k+"\x26description\x3d"+d,g="https://plus.google.com/share?url\x3d"+f+"\x26t\x3d",h="mailto:?to\x3d\x26subject\x3d"+
_("Check out this Live Blog")+"\x26body\x3d"+f,p="http://www.facebook.com/sharer.php?s\x3d100",p=p+("\x26p[title]\x3d"+d),p=p+("\x26p[summary]\x3d"+j),p=p+("\x26p[url]\x3d"+f),u=0;b(".result-content img",a.el).each(function(){var a=b(this).attr("src");p+="\x26p[images]["+u+"]\x3d"+a;u++});d={fbclick:"$.socialShareWindow('"+p+"',400,570); return false;",twtclick:"$.socialShareWindow('http://twitter.com/home?status\x3d"+_("Now reading ")+d+": "+f+"',400,570); return false;",linclick:"$.socialShareWindow('http://www.linkedin.com/shareArticle?mini\x3dtrue\x26url\x3d"+
f+"\x26title\x3d"+d+"\x26summary\x3d"+j+"', 400, 570); return false;",pinclick:"$.socialShareWindow('"+k+"', 400, 700); return false;",gglclick:"$.socialShareWindow('"+g+"', 400, 570); return false;",emailclick:"$.socialShareWindow('"+h+"', 1024, 768); return false;",emailurl:h};b.tmpl("theme/item/social-share",d,function(a,d){e.after(d);e.attr("data-added","yes")})}b('input[data-type\x3d"permalink"]',a.el).css("visibility","hidden");b(this).next(".share-box").toggle()})}});setTimeout(function(){})}})});
define("utils/date-format",["jquery","jquery/i18n"],function(){var b,f=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,a=function(a,c){a=String(a);for(c=c||2;a.length<c;)a="0"+a;return a};b=function(d,k,j){1==arguments.length&&("[object String]"==Object.prototype.toString.call(d)&&!/\d/.test(d))&&(k=d,d=void 0);d=d?new Date(d):new Date;
if(isNaN(d))throw SyntaxError("invalid date");k=String(b.masks[k]||k||b.masks["default"]);"UTC:"==k.slice(0,4)&&(k=k.slice(4),j=!0);var g=j?"getUTC":"get",h=d[g+"Date"](),l=d[g+"Day"](),m=d[g+"Month"](),o=d[g+"FullYear"](),q=d[g+"Hours"](),s=d[g+"Minutes"](),t=d[g+"Seconds"](),g=d[g+"Milliseconds"](),r=j?0:d.getTimezoneOffset(),p={d:h,dd:a(h),ddd:b.i18n.dayNames[l],dddd:b.i18n.dayNames[l+7],m:m+1,mm:a(m+1),mmm:b.i18n.monthNames[m],mmmm:b.i18n.monthNames[m+12],yy:String(o).slice(2),yyyy:o,h:q%12||
12,hh:a(q%12||12),H:q,HH:a(q),M:s,MM:a(s),s:t,ss:a(t),l:a(g,3),L:a(99<g?Math.round(g/10):g),t:12>q?"a":"p",tt:12>q?"am":"pm",T:12>q?"A":"P",TT:12>q?"AM":"PM",Z:j?"UTC":(String(d).match(e)||[""]).pop().replace(c,""),o:(0<r?"-":"+")+a(100*Math.floor(Math.abs(r)/60)+Math.abs(r)%60,4),S:["th","st","nd","rd"][3<h%10?0:(10!=h%100-h%10)*h%10]};return k.replace(f,function(a){return a in p?p[a]:a.slice(1,a.length-1)})};b.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",
longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};b.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};
Date.prototype.format=function(a,c){return b(this,a,c)};return b});
define("utils/ie-polyfill",[],function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){if(void 0===this||null===this)throw new TypeError;var f=Object(this),e=f.length>>>0;if(0===e)return-1;var c=0;0<arguments.length&&(c=Number(arguments[1]),c!==c?c=0:0!==c&&(Infinity!==c&&-Infinity!==c)&&(c=(0<c||-1)*Math.floor(Math.abs(c))));if(c>=e)return-1;for(c=0<=c?c:Math.max(e-Math.abs(c),0);c<e;c++)if(c in f&&f[c]===b)return c;return-1})});
define("livedesk-embed/dispatcher",["jquery"],function(b){var f=function(){};f.prototype={on:function(e,c){b(this).on(e,function(a,d){c.call(d)})},triggerHandler:function(e,c){b(this).triggerHandler(e,[c])}};b.dispatcher=new f});define("window",[],function(){return window});define("document",[],function(){return document});
define("jquery/scrollspy",["jquery","window","document"],function(b,f){b.fn.extend({scrollspy:function(e){e=b.extend({},{min:0,max:0,mode:"vertical",buffer:0,container:f,onEnter:e.onEnter?e.onEnter:[],onLeave:e.onLeave?e.onLeave:[],onTick:e.onTick?e.onTick:[]},e);return this.each(function(){var c=this,a=e,d=b(a.container),f=a.mode,j=a.buffer,g=leaves=0,h=!1;d.bind("scroll",function(){var e={top:b(this).scrollTop(),left:b(this).scrollLeft()},m="vertical"==f?e.top+j:e.left+j,o=a.max,q=a.min;b.isFunction(a.max)&&
(o=a.max());b.isFunction(a.min)&&(q=a.min());0==o&&(o="vertical"==f?d.height():d.outerWidth()+b(c).outerWidth());if(m>=q&&m<=o){if(!h&&(h=!0,g++,b(c).trigger("scrollEnter",{position:e}),b.isFunction(a.onEnter)))a.onEnter(c,e);b(c).trigger("scrollTick",{position:e,inside:h,enters:g,leaves:leaves});if(b.isFunction(a.onTick))a.onTick(c,e,h,g,leaves)}else if(h&&(h=!1,leaves++,b(c).trigger("scrollLeave",{position:e,leaves:leaves}),b.isFunction(a.onLeave)))a.onLeave(c,e)})})}})});
define("livedesk-embed/collections/autocollection",["gizmo/superdesk"],function(b){return b.Collection.extend({_timeInterval:1E4,_idInterval:0,_stats:{},keep:!1,resetStats:function(){this._stats={limit:15,offset:0,lastCId:0,fistOrder:Infinity,total:0}},init:function(){var b=this;b.resetStats();b.model.on("publish reorder",function(e,c){b._stats.lastCId+1===parseInt(c.get("CId"))&&b._stats.lastCId++});b.on("read readauto",function(e,c,a){b._stats.offset=b._stats.limit;b._stats.total=parseInt(a.total);
a.lastCId=parseInt(a.lastCId);a.lastCId>b._stats.lastCId&&(b._stats.lastCId=a.lastCId);b.getFirstOrder(c)}).on("readauto updatesauto addingsauto removeingsauto update",function(e,c){b.getLastCid(c);b.getFirstOrder(c)}).on("addingsauto",function(e,c){b._stats.total+=c.length;b._stats.offset+=c.length}).on("removeingsauto",function(e,c){b._stats.total-=c.length;b._stats.offset-=c.length}).on("addings",function(e,c){b._stats.offset+=c.length})},destroy:function(){this.stop()},auto:function(b){var e=
this;ret=this.stop().start(b);this._idInterval=setInterval(function(){e.start(b)},this._timeInterval);return ret},start:function(b){b=b||{};b=$.extend(!0,{data:{"cId.since":this._stats.lastCId,"order.start":this._stats.fistOrder},headers:{"X-Filter":this._xfilter,"X-Format-DateTime":"yyyy-MM-ddTHH:mm:ss'Z'"}},b);0===this._stats.lastCId&&(delete b.data["cId.since"],delete b.data["order.start"]);if(!this.keep&&this.view&&!this.view.checkElement())this.stop();else return this.triggerHandler("beforeUpdate"),
this.autosync(b)},stop:function(){clearInterval(this._idInterval);return this},getFirstOrder:function(b){for(var e=0,c,a=b.length;e<a;e++)c=parseFloat(b[e].get("Order")),!isNaN(c)&&this._stats.fistOrder>c&&(this._stats.fistOrder=c)},getLastCid:function(b){for(var e=0,c,a=b.length;e<a;e++)c=parseInt(b[e].get("CId")),!isNaN(c)&&this._stats.lastCId<c&&(this._stats.lastCId=c)},autosync:function(b){var e=this;return this.href&&this.syncAdapter.request.call(this.syncAdapter,this.href).read(b).done(function(b){var a=
e.parseAttributes(b);b=e._parse(b);for(var d=[],f=[],j=[],g=[],h=e._list.length,l=0;l<b.length;l++){for(var m=!1,o=0;o<e._list.length;o++)if(b[l].hash()==e._list[o].hash()){m=b[l];break}if(m)if(e.hasEvent("updatesauto")&&j.push(m),e.isCollectionDeleted(m)&&(e._list.splice(o,1),e.hasEvent("removeingsauto")&&f.push(m)),m.isDeleted())m._remove();else if(m.isChanged())d.push(m);else m.on("delete",function(){e.remove(this.hash())}).on("garbage",function(){this.desynced=!0});else e.isCollectionDeleted(b[l])?
e.hasEvent("removeingsauto")&&e.hasEvent("removeingsauto")&&f.push(b[l]):b[l].isDeleted()?e.hasEvent("updatesauto")&&j.push(b[l]):(e._list.push(b[l]),d.push(b[l]),e.hasEvent("addingsauto")&&g.push(b[l]))}e.desynced=!1;0===h?e.triggerHandler("readauto",[e._list,a]):(j.length&&e.hasEvent("updatesauto")&&e.triggerHandler("updatesauto",[j,a]),g.length&&e.hasEvent("addingsauto")&&e.triggerHandler("addingsauto",[g,a]),f.length&&e.hasEvent("removeingsauto")&&e.triggerHandler("removeingsauto",[f,a]),e.triggerHandler("updateauto",
[d,a]))})}},{register:"AutoCollection"})});define("livedesk-embed/models/user",["gizmo/superdesk"],function(b){return b.Model.extend({},{register:"User"})});
define("livedesk-embed/models/post",["gizmo/superdesk","livedesk-embed/models/user","utils/extend"],function(b){return b.Model.extend({defaults:{Creator:b.Register.User},services:{flickr:!0,google:!0,twitter:!0,facebook:!0,youtube:!0},getClass:function(){switch(this.get("Type").Key){case "wrapup":return"wrapup";case "quote":return"quotation";case "advertisement":return"advertisement";default:return this.isService()?"service":"tw"}},isService:function(){return this.get("AuthorName")in this.services},
isQuote:function(){return"quotation"==this.getClass()},twitter:{link:{anchor:function(b){return b.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/g,function(b){b=b.link(b);return b=b.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},user:function(b){return b.replace(/[@]+[A-Za-z0-9-_]+/g,function(b){var c=b.replace("@","");b=b.link("http://twitter.com/"+c);return b=b.replace('href\x3d"','target\x3d"_blank" onclick\x3d"loadProfile(\''+c+'\');return(false);"  href\x3d"')})},tag:function(b){return b.replace(/[#]+[A-Za-z0-9-_]+/g,
function(b){var c=b.replace(" #"," %23");b=b.link("http://summize.com/search?q\x3d"+c);return b=b.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},all:function(b){b=this.anchor(b);b=this.user(b);return b=this.tag(b)}}}},{register:"Post"})});
define("livedesk-embed/collections/posts",["gizmo/superdesk","livedesk-embed/collections/autocollection","livedesk-embed/models/post"],function(b){return b.Register.AutoCollection.extend({parse:function(b){void 0!==b.total&&(b.total=parseInt(b.total),this.listTotal=b.total,delete b.total);return b.PostList?b.PostList:b},parseAttributes:function(b){return{lastCId:b.lastCId,offset:b.offset,offsetMore:b.offsetMore,total:b.total,limit:b.limit}},isCollectionDeleted:function(b){return"False"===b.get("IsPublished")},
model:b.Register.Post},{register:"Posts"})});define("livedesk-embed/models/blog",["gizmo/superdesk","livedesk-embed/collections/posts"],function(b){return b.Model.extend({defaults:{PostPublished:b.Register.Posts}},{register:"Blog"})});
define("jquery/xdomainrequest",["jquery"],function(b){b.support.cors=!0;var f=0,e=0;this.XDomainRequest&&b.ajaxTransport("+*",function(c){if(c.crossDomain&&c.async){c.timeout&&(c.xdrTimeout=c.timeout,delete c.timeout);var a,d;return{send:function(k,j){function g(d,c,e,f){a.onload=a.onerror=a.ontimeout=b.noop;a=void 0;j(d,c,e,f)}a=new XDomainRequest;if(c.dataType){var h="";for(i in c.headers)h+=i+"\x3d"+encodeURIComponent(c.headers[i])+"\x26";h=h.replace(/(\s+)?.$/,"");c.url=c.url+(-1===c.url.indexOf("?")?
"?":"\x26")+h}a.open(c.type,c.url);d=c.processTime?c.processTime:80*f++;a.onload=function(){setTimeout(function(){g(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType);f=0},e)};e=d;a.onerror=function(){g(404,"Not Found")};c.xdrTimeout&&(a.ontimeout=function(){g(0,"timeout")},a.timeout=c.xdrTimeout);a.send(c.hasContent&&c.data||null)},abort:function(){a&&(a.onerror=b.noop(),a.abort())}}}})});
define("livedesk-embed/views/timeline","jquery gizmo/view-events livedesk-embed/views/post utils/date-format utils/ie-polyfill livedesk-embed/dispatcher jquery/tmpl jquery/scrollspy livedesk-embed/models/blog tmpl!theme/container jquery/xdomainrequest".split(" "),function(b,f,e,c){c.i18n={dayNames:_("Sun,Mon,Tue,Wed,Thu,Fri,Sat,Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday").toString().split(","),monthNames:_("Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec,January,February,March,April,May,June,July,August,September,October,November,December").toString().split(",")};
return f.View.extend({limit:6,hashIdentifier:"livedeskitem\x3d",location:"",_views:[],el:"#livedesk-root",timeInterval:1E4,events:{"#loading-more":{click:"loadingMore"},"#load-more":{click:"loadMore"}},idInterval:0,flags:{},scroll:{element:null,start:0},resetFlags:function(){this.flags={addAllPending:!1,more:!1,loadingMore:!1,atEnd:!1}},autoRender:!0,pendingAutoupdates:[],loadMore:function(){this.resetFlags();this.el.find("#liveblog-post-list").html("");i=0;for(count=this._views.length;i<count;i++)this._views[i].rendered=
!1;this._views=[];delete this.filters;var a=this.model.get("PostPublished");a._list=[];a.resetStats();a.limit(a._stats.limit).offset(a._stats.offset).auto({data:{thumbSize:"medium"}});b(this).hide()},showLiner:function(){b("#load-more").show()},loadingMore:function(){var a=this;console.log(a.flags);!a.flags.atEnd&&!a.flags.loadingMore&&(a.flags.loadingMore=!0,a.flags.more=!0,a.model.get("PostPublished"),postPublished=a.model.get("PostPublished"),a.filters&&b.each(a.filters,function(a,b){postPublished[a].apply(postPublished,
b)}),postPublished.xfilter(a.xfilter).limit(postPublished._stats.limit).offset(postPublished._stats.offset).sync({data:{thumbSize:"medium"}}).done(function(){var b=a.model.get("PostPublished").total;a.toggleMoreVisibility();a._views.length>=b&&(a.flags.atEnd=!0);a.flags.more=!1;a.flags.loadingMore=!1}))},more:function(){var a=this;!a.flags.atEnd&&!a.flags.more&&(a.flags.more=!0,a.model.get("PostPublished"),postPublished=a.model.get("PostPublished"),a.filters&&b.each(a.filters,function(a,b){postPublished[a].apply(postPublished,
b)}),postPublished.xfilter(a.xfilter).limit(postPublished._stats.limit).offset(postPublished._stats.offset).sync().done(function(){var d=a.model.get("PostPublished").total;a._views.length>=d&&(a.flags.atEnd=!0,b("#loading-more",a.el).hide());a.flags.more=!1}))},setIdInterval:function(a){this.idInterval=setInterval(a,this.timeInterval);return this},pause:function(){clearInterval(this.idInterval);return this},sync:function(){var a=this;this.auto().pause().setIdInterval(function(){a.auto()})},auto:function(){this.model.xfilter().sync({force:!0});
return this},ensureStatus:function(){if(this.model.get("ClosedOn")){var a=new Date(this.model.get("ClosedOn"));this.pause();this.model.get("PostPublished").stop();this.el.find("#liveblog-status-time").html(_("The liveblog coverage was stopped ")+a.format(_("mm/dd/yyyy HH:MM")))}},gotoHash:function(){if(0<location.hash.length){var a=location.hash;location.hash="";location.hash=a}},init:function(){var a=this;a.resetFlags();a._views=[];a.location=window.location.href.split("#")[0];a.rendered=!1;"string"===
b.type(a.url)&&(a.model=new f.Register.Blog(a.url.replace("my/","")));a.xfilter="PublishedOn, DeletedOn, Order, Id, CId, Content, CreatedOn, Type, AuthorName, Author.Source.Name, Author.Source.Id, IsModified, AuthorImage, AuthorPerson.EMail, AuthorPerson.FirstName, AuthorPerson.LastName, AuthorPerson.Id, Meta, IsPublished, Creator.FullName";a.model.on("read",function(){if(!a.rendered){var b,c=window.location.href.split("?"),e=a.model.get("PostPublished");e.on("read readauto",a.render,a).on("addings",
a.addAll,a).on("addingsauto",a.addAllAutoupdate,a).on("removeingsauto",a.removeAllAutoupdate,a).on("updateauto readauto",a.updateStatus,a).on("beforeUpdate",a.updateingStatus,a).xfilter(a.xfilter).limit(e._stats.limit);c[1]&&-1!==(b=c[1].indexOf(a.hashIdentifier))?(b=parseFloat(c[1].substr(b+a.hashIdentifier.length)),a.filters={end:[b,"order"]},e.one("rendered",a.showLiner,a).end(b,"order").sync({data:{thumbSize:"medium"}})):e.offset(e._stats.offset).auto({data:{thumbSize:"medium"}})}a.rendered=!0}).on("update",
function(){a.ensureStatus();a.renderBlog()});a.sync()},removeOne:function(a){var b=this._views.indexOf(a);a=this.model.get("PostPublished")._list.indexOf(a.model);-1!==b&&(this.model.get("PostPublished").total--,this._views.splice(b,1),-1!==a&&this.model.get("PostPublished")._list.splice(a,1),this.markScroll());return this},orderOne:function(a){var b=this._views.indexOf(a);a.order=parseFloat(a.model.get("Order"));-1===b&&this._views.push(a);this._views.sort(function(a,b){return b.order-a.order});
b=this._views.indexOf(a);0===b?1===this._views.length?this.el.find("#load-more").after(a.el):a.el.insertBefore(this._views[1].el):a.el.insertAfter(this._views[b-1].el);return a},addOne:function(a){var b=new e({model:a,_parent:this});a.postView=b;return this.orderOne(b)},toggleStatusCount:function(){if(0!==this.pendingAutoupdates.length){var a=this.pendingAutoupdates.length;b("#liveblog-status-count",this.el).text(ngettext("one new post","%(count)s new posts",a).format({count:a})).show()}else b("#liveblog-status-count",
this.el).hide()},removeAllAutoupdate:function(a,b){for(var c in b)"postView"in b[c]&&b[c].postView.remove();this.markScroll()},addAllAutoupdate:function(a,b){if(this.autoRender){if(b.length){for(var c=0,e=b.length;c<e;c++)this.addOne(b[c]),this.model.get("PostPublished").total++;this.markScroll()}}else 0!==b.length&&(this.pendingAutoupdates=this.pendingAutoupdates.concat(b),this.toggleStatusCount())},addAllPending:function(){if(!this.flags.addAllPending&&this.pendingAutoupdates.length){this.flags.addAllPending=
!0;for(var a=0,b=this.pendingAutoupdates.length;a<b;a++)this.addOne(this.pendingAutoupdates[a]);this.pendingAutoupdates=[];this.toggleStatusCount();this.markScroll()}this.flags.addAllPending=!1},addAll:function(a,b){var c;c=0;for(count=b.length;c<count;c++)this.addOne(b[c]);this.toggleMoreVisibility()},updateingStatus:function(){this.el.find("#liveblog-status-time").html(_("updating..."))},updateStatus:function(){var a=this,c=new Date;this.el.find("#liveblog-status").fadeOut(function(){var e='\x3ctime data-date\x3d"'+
c.getTime()+'"\x3e'+c.format(_("HH:MM"))+"\x3c/time\x3e";b(this).find("#liveblog-status-time").html(_("updated on %s").format([e])).end().fadeIn();b.dispatcher.triggerHandler("after-render",a)})},renderBlog:function(){b(this.el).find('[gimme\x3d"blog.title"]').html(this.model.get("Title")).end().find('[gimme\x3d"blog.description"]').html(this.model.get("Description"))},toggleMoreVisibility:function(){this.model.get("PostPublished")._stats.offset>=this.model.get("PostPublished")._stats.total?b("#loading-more",
this.el).hide():b("#loading-more",this.el).show()},markScroll:function(){this.scroll.element=b("#liveblog-posts :not(#load-more)",this.el).first();this.scroll.start=this.scroll.element.offset().top},render:function(){var a=this,c,e;e=a.model.get("PostPublished");a.el.tmpl("theme/container");a.renderBlog();a.ensureStatus();c=e._list;e.total=e.listTotal;a.toggleMoreVisibility();var f=c.length;a.views=[];a.renderedTotal=f;for(var f=0,g=c.length;f<g;f++)c[f].on("rendered",a.renderedOn,a),e=a.addOne(c[f]),
a.views.push(e);a.model.get("PostPublished").triggerHandler("rendered");b("#pintotop,#liveblog-status-count",a.el).on(a.getEvent("click"),function(c){c.preventDefault();b("#liveblog-posts",a.el).scrollTop(0)});a.markScroll();b("#liveblog-posts",a.el).scroll(function(){!a.flags.atEnd&&b(this).outerHeight()===b(this).get(0).scrollHeight-b(this).scrollTop()&&a.more();a.scroll.element.offset().top<a.scroll.start?(a.autoRender=!1,b("#liveblog-status",a.el).addClass("shadow")):(a.autoRender=!0,a.addAllPending(),
b("#liveblog-status",a.el).removeClass("shadow"))});b.dispatcher.triggerHandler("after-render",this)},renderedOn:function(){this.renderedTotal--;this.renderedTotal||this.closeAllButFirstWrapup()},closeAllButFirstWrapup:function(a){a=this.views;a.reverse();for(var c=0;c<a.length;c++)b(a[c].el).hasClass("wrapup")&&a[c]._toggleWrap(b(a[c].el))}})});define("livedesk-embed/plugins",function(){});